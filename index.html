<!DOCTYPE html>
<html lang="en-us">

  <head>
  <!---
  <link href="http://gmpg.org/xfn/11" rel="profile">
  -->
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Dr. Heuna Kim &middot; Mathematics and Computer Science
    
  </title>

  
      
  <link rel="canonical" href="https://heuna-kim.net/index.html">
      
  

  <link rel="stylesheet" href="https://heuna-kim.net/css/poole.css">
  <link rel="stylesheet" href="https://heuna-kim.net/css/syntax.css">
  <link rel="stylesheet" href="https://heuna-kim.net/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="shortcut icon" href="https://heuna-kim.net/images/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://heuna-kim.net/atom.xml">

  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  <!--- deactivate google analytics
  {% if site.google_analytics_id %}
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', '{{ site.google_analytics_id }}', 'auto');
    ga('send', 'pageview');
  </script>
  {% endif %}
  -->
</head>


  <body class="theme-base-0d">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A Blog about Nerdy and Artistic Things</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item active" href="https://heuna-kim.net">Home</a>

    <!--- The code below dynamically generates a sidebar nav of the files in the folder /pages -->

    
      
        <a class="sidebar-nav-item" href="https://heuna-kim.net/pages/About.html">About</a>
      
    
      
        <a class="sidebar-nav-item" href="https://heuna-kim.net/pages/Projects.html">Projects</a>
      
    
      
        <a class="sidebar-nav-item" href="https://heuna-kim.net/pages/Publications.html">Publications</a>
      
    

    <a class="sidebar-nav-item" href="https://heuna-kim.net/archive.html">Archive</a>

  </nav>

  <div class="sidebar-item">
    <p>
        &copy; 2020 <a href="mailto:ai@heuna-kim.net">Heuna Kim</a>.  <br>
        All rights reserved.
    </p>
    <p>
        <img src="https://heuna-kim.net/logos_and_icons/haskell-logo.png" class="logo" style="display: inline; margin: 0 0 0;" />
        Site created with
        <a href="https://jaspervdj.be/hakyll">Hakyll</a>.  <br>
        Modified theme
        <a href="https://github.com/hahey/lanyon-hakyll">lanyon-hakyll</a>
        based on
        <a href="https://lanyon.getpoole.com/">Lanyon</a>.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="https://heuna-kim.net" title="Home">Dr. Heuna Kim</a>
            <small>Mathematics and Computer Science</small>
          </h3>
        </div>
      </div>

      <div class="container content">
          <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="./posts/2020-11-19-Hakyll-Sidebar-Activation.html">
        Dynamic Sidebar or Header Activation based on the Current Page in Hakyll
      </a>
    </h1>
    <span class="post-date">November 19, 2020,
      
         Posted by Heuna Kim
      
    </span>

    <h2 id="situation">Situation</h2>
<p>The problem is an extension of what is described in <a href="http://mesokurtosis.com/posts/2015-02-22-pages.html">this blog</a>.</p>
<p>The page that you are navigating will be linked to one in your sidebar or your header depending on your layout unless it is one of posts. It is possible to statically link each of such pages manually. But if this list of pages is dynamically generated by loading all pages in some folder (e.g.Â in the <code>pages</code> folder in <a href="https://github.com/hahey/lanyon-hakyll">lanyon-hakyll</a>), it gets somewhat more complicated in Hakyll for the following reason.</p>
<p>An example based on liquid syntax in ruby for such activation will look like (the excerpt from <a href="https://github.com/poole/lanyon/blob/master/_includes/sidebar.html">Lanyon</a>):</p>
<pre><code>{% for node in pages_list %}
    {% if node.title != null %}
          &lt;a class=&quot;sidebar-nav-item{% if page.url == node.url %} active{% endif %}&quot; href=&quot;{{ node.url | absolute_url }}&quot;&gt;{{ node.title }}&lt;/a&gt;
    {% endif %}
{% endfor %}</code></pre>
<p>A direct translation of <code>{% if page.url == node.url %}</code> in Hakyll is not possible, because the control flow of Hakyll <code>$if(variable)$</code> does not evaluate the boolean value of <code>variable</code> but merely checks if the key <code>variable</code> exists in the current context or not. Check out <a href="https://jaspervdj.be/hakyll/tutorials/04-compilers.html">this tutorial</a> for understanding the control flow of Hakyll templates.</p>
<h2 id="approaching-the-solution">Approaching the Solution</h2>
<p>We will dynamically generate this <code>constField</code> having the page title as a key in the context of <code>listField</code> with a key <code>pages_list</code>. First add snapshot to avoid a dependency cycle in compiling the <code>pages</code> folder:</p>
<pre><code> match &quot;pages/*&quot; $ do
    ...
    pandocCompiler
    ...
    &gt;&gt;= saveSnapshot &quot;page-content&quot;</code></pre>
<p>Define the context containing such <code>listField</code>:</p>
<pre><code>sidebarCtx :: Context String -&gt; Context String
sidebarCtx nodeCtx =
    listField &quot;pages_list&quot; nodeCtx (loadAllSnapshots &quot;pages/*&quot; &quot;page-content&quot;) `mappend`
    defaultContext

baseNodeCtx :: Context String
baseNodeCtx =
    urlField &quot;node-url&quot; `mappend`
    titleField &quot;title&quot; `mappend`
    baseCtx

baseSidebarCtx = sidebarCtx baseNodeCtx</code></pre>
<p>Add dynamically generated <code>constField</code> with the current page title.</p>
<pre><code>--- This is not enough.
import           System.FilePath               (takeBaseName)

match &quot;pages/*&quot; $ do
    route $ setExtension &quot;html&quot;
    compile $ do
        pageName &lt;- takeBaseName . toFilePath &lt;$&gt; getUnderlying
        let pageCtx = constField pageName &quot;&quot; `mappend`
                      baseNodeCtx
        let activeSidebarCtx = sidebarCtx pageCtx

        pandocCompiler
            &gt;&gt;= saveSnapshot &quot;page-content&quot;
            ...
            &gt;&gt;= loadAndApplyTemplate &quot;templates/default.html&quot; (activeSidebarCtx &lt;&gt; siteCtx)
            &gt;&gt;= relativizeUrls</code></pre>
<p>The translation of the above html layout will be similar to:</p>
<pre><code>&lt;!-- THIS DOES NOT WORK --&gt;
$for(pages_list)$
    $if(title)$
          &lt;a class=&quot;sidebar-nav-item$if($title$)$ active$endif$&quot; href=&quot;$baseurl$$node-url$&quot;&gt;$title$&lt;/a&gt;
    $endif$
$endfor$</code></pre>
<p>As you see in the comment, this is not enough because inside of <code>$if(...)$</code> syntax, you cannot evaluate the key by surrounding them with <code>$</code>.</p>
<h2 id="solution">Solution</h2>
<p>You can add <code>functionField</code> for evaluating the key for a given context. The <code>functionField</code> needs a function with a type <code>[String] -&gt; Item String -&gt; Compiler String</code>.</p>
<p>We define the following <code>evalCtxKey</code> function for this purpose:</p>
<pre><code>evalCtxKey :: Context String -&gt; [String] -&gt; Item String -&gt; Compiler String
evalCtxKey context [key] item = (unContext context key [] item) &gt;&gt;= \cf -&gt;
        case cf of
            StringField s -&gt; return s
            _             -&gt; error $ &quot;Internal error: StringField expected&quot;</code></pre>
<p>Just if you need, you can also access the meta data as follows:</p>
<pre><code>getMetadataKey :: [String] -&gt; Item String -&gt; Compiler String
getMetadataKey [key] item = getMetadataField' (itemIdentifier item) key</code></pre>
<p>The functions <code>unContext</code>, <code>getMetadataField'</code>, and data <code>itemIdentifier</code> are already defined in Hakyll.</p>
<p>The following is the working version of compiling <code>pages/*</code>:</p>
<pre><code>match &quot;pages/*&quot; $ do
    route $ setExtension &quot;html&quot;
    compile $ do
        pageName &lt;- takeBaseName . toFilePath &lt;$&gt; getUnderlying
        let pageCtx = constField pageName &quot;&quot; `mappend`
                      baseNodeCtx
        let evalCtx = functionField &quot;eval&quot; (evalCtxKey pageCtx)
        let activeSidebarCtx = sidebarCtx (evalCtx &lt;&gt; pageCtx)

        pandocCompiler
            &gt;&gt;= saveSnapshot &quot;page-content&quot;
            ...
            &gt;&gt;= loadAndApplyTemplate &quot;templates/default.html&quot; (activeSidebarCtx &lt;&gt; siteCtx)
            &gt;&gt;= relativizeUrls</code></pre>
<p>and the sidebar layout:</p>
<pre><code>$for(pages_list)$
    $if(title)$
          &lt;a class=&quot;sidebar-nav-item$if(eval(title))$ active$endif$&quot; href=&quot;$baseurl$$node-url$&quot;&gt;$title$&lt;/a&gt;
    $endif$
$endfor$</code></pre>
<p>If you want to look at an example code, please check out <a href="https://github.com/hahey/lanyon-hakyll">the codes of lanyon-hakyll</a>.</p>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="./posts/2020-09-14-hakyll-blog-migration.html">
        Migrated notes and the webpage using Hakyll
      </a>
    </h1>
    <span class="post-date">September 14, 2020,
      
         Posted by Heuna Kim
      
    </span>

    <p>Other old notes will be updated sooner or later.</p>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="./posts/2018-10-17-PaperReview-SISR-GAN.html">
        Paper Review for Photo-Realistic SISR Using a GAN
      </a>
    </h1>
    <span class="post-date">October 17, 2018,
      
         Posted by Heuna Kim
      
    </span>

    <p><a href="https://arxiv.org/abs/1609.04802">Link:Paper</a></p>
<h4 id="main-contribution">Main Contribution</h4>
<ul>
<li>SRResNet : set a new best benchmark result for SISR for PSNR measure</li>
<li>SRGAN:
<ul>
<li>Content loss: a variant of pixel-wise loss depending on the network feature map</li>
<li>Adversarial loss: the probability of the discriminator over all training samples \[ l_{Gen}^{SR} = \sum_{n=1}^N - log D_{\theta_D}(G_{\theta_G}(I^{LR})) \]</li>
<li>GAN based minmax between generated and original \[ \min_{\theta_G} \max_{\theta_D} E_{I^{HR} \sim p_{train}(I^{HR})} [\log D_{\theta_D}(I^{HR})] + E_{I^{LR} \sim p_G(I^{LR})} [\log(1- D_{\theta_D}(G_{\theta_G}(I^{HR})))] \]</li>
<li>performance improvement on MOS testing by a far margin</li>
</ul></li>
</ul>
<h4 id="relevant-terminologies-to-understand">Relevant Terminologies to understand</h4>
<ul>
<li>perceptual similarity</li>
<li>SSIM - structural similarity</li>
<li>PSNR - peak signal-to-noise ratio</li>
<li>MOS - mean opinion score</li>
<li>Wilcoxon signed-rank tests</li>
<li>Parametric ReLu</li>
</ul>
<h4 id="interesting-relevant-work">Interesting Relevant Work</h4>
<ul>
<li><a href="https://pdfs.semanticscholar.org/a286/af401232dcf181af6790873d92585a85f370.pdf">SISR benchmarks</a></li>
<li><a href="https://link.springer.com/article/10.1007/s00138-014-0623-4">SR survey</a></li>
<li><a href="https://arxiv.org/abs/1511.06434">GAN guideline</a></li>
<li><a href="http://people.duke.edu/~sf59/srfinal.pdf%20https://pdfs.semanticscholar.org/938c/a67787b1eb942648f7640c4c07994a0d74de.pdf">multi SR</a></li>
<li><a href="http://torch.ch/blog/2016/02/04/resnets.html">Resnet guideline</a></li>
</ul>
  </div>
  
</div>

<div class="pagination">
  
    <span class="pagination-item newer">Newer</span>
  
  
    <a class="pagination-item older" href="./2/index.html">Older</a>
  
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src="https://heuna-kim.net/public/js/script.js"></script>

  </body>

</html>
